(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1d60a4f4"],{a15b:function(e,t,n){"use strict";var r=n("23e7"),u=n("44ad"),c=n("fc6a"),o=n("a640"),a=[].join,i=u!=Object,l=o("join",",");r({target:"Array",proto:!0,forced:i||!l},{join:function(e){return a.call(c(this),void 0===e?",":e)}})},cf7c:function(e,t,n){"use strict";n.d(t,"m",(function(){return c})),n.d(t,"d",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"o",(function(){return i})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return s})),n.d(t,"l",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return j})),n.d(t,"n",(function(){return O})),n.d(t,"h",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"a",(function(){return g})),n.d(t,"p",(function(){return v}));var r=n("b775"),u={getRoleList:"/role/getRoleList",getAddMenuList:"/role/addGetMenuTree",getEditMenuList:"/role/editGetMenuTree",addRole:"/role/addRole",eidtRole:"/role/editRole",removeRole:"/role/removeRole",getMenuTree:"/menu/getMenuTree",addMenuTree:"/menu/addMenu",getMenuList:"/menu/getMenuList",editMenuTree:"/menu/editMenu",removeMenuTree:"/menu/removeMenu",getAccountList:"/users/getAccountList",addAccount:"/users/addAccount",delAccount:"/users/delAccount",accountStatusSet:"/users/accountStatusSet",resultPassWord:"/users/resultPassWord",roleAssignment:"/users/roleAssignment"};function c(e){return Object(r["a"])({url:u.getRoleList,method:"post",data:e})}function o(e){return Object(r["a"])({url:u.addRole,method:"post",data:e})}function a(e){return Object(r["a"])({url:u.eidtRole,method:"post",data:e})}function i(e){return Object(r["a"])({url:u.removeRole,method:"post",data:{id:e}})}function l(){return Object(r["a"])({url:u.getAddMenuList,method:"post"})}function s(e){return Object(r["a"])({url:u.getEditMenuList,method:"post",data:{id:e}})}function d(e){return Object(r["a"])({url:u.getMenuTree,method:"post",data:e})}function f(){return Object(r["a"])({url:u.getMenuList,method:"post"})}function b(e){return Object(r["a"])({url:u.addMenuTree,method:"post",data:e})}function j(e){return Object(r["a"])({url:u.editMenuTree,method:"post",data:e})}function O(e){return Object(r["a"])({url:u.removeMenuTree,method:"post",data:{id:e}})}function m(){return Object(r["a"])({url:u.getAccountList,method:"post"})}function p(e){return Object(r["a"])({url:u.addAccount,method:"post",data:e})}function h(e){return Object(r["a"])({url:u.delAccount,method:"post",data:{id:e}})}function g(e){return Object(r["a"])({url:u.accountStatusSet,method:"post",data:e})}function v(e){return Object(r["a"])({url:u.roleAssignment,method:"post",data:e})}},dc0a:function(e,t,n){"use strict";n.r(t);var r=n("f2bf"),u=Object(r["l"])("新增账号+"),c={class:"table-action"},o={key:0},a={key:1},i={key:2};function l(e,t,n,l,s,d){var f=Object(r["K"])("a-button"),b=Object(r["K"])("a-table"),j=Object(r["K"])("a-card"),O=Object(r["K"])("a-col"),m=Object(r["K"])("add-edit-account"),p=Object(r["K"])("definition-role"),h=Object(r["K"])("a-row");return Object(r["D"])(),Object(r["j"])(h,null,{default:Object(r["T"])((function(){return[Object(r["m"])(O,{span:24},{default:Object(r["T"])((function(){return[Object(r["m"])(j,null,{default:Object(r["T"])((function(){return[Object(r["m"])(f,{type:"primary",style:{margin:"10px 0px"},onClick:l.addAccount},{default:Object(r["T"])((function(){return[u]})),_:1},8,["onClick"]),Object(r["m"])(b,{dataSource:l.data,bordered:"",rowKey:"_id",scroll:{x:1300},columns:l.columns},{status:Object(r["T"])((function(e){var t=e.text;return[Object(r["m"])("div",null,Object(r["M"])(l.statusMapFilter(t)),1)]})),action:Object(r["T"])((function(e){e.text;var t=e.record;return[Object(r["m"])("ul",c,[Object(r["m"])("li",null,[Object(r["m"])("a",{onClick:function(e){return l.removeAccount(t._id)}}," 删除 ",8,["onClick"])]),0==t.status?(Object(r["D"])(),Object(r["j"])("li",o,[Object(r["m"])("a",{onClick:function(e){return l.setAccountStatus(t._id,1)}}," 启用 ",8,["onClick"])])):Object(r["k"])("",!0),1==t.status?(Object(r["D"])(),Object(r["j"])("li",a,[Object(r["m"])("a",{onClick:function(e){return l.setAccountStatus(t._id,0)}}," 禁用 ",8,["onClick"])])):Object(r["k"])("",!0),1==t.status?(Object(r["D"])(),Object(r["j"])("li",i,[Object(r["m"])("a",{onClick:function(e){return l.setRole(t)}}," 定义角色 ",8,["onClick"])])):Object(r["k"])("",!0)])]})),_:1},8,["dataSource","columns"])]})),_:1})]})),_:1}),Object(r["m"])(m,{ref:"account",onRefresh:l.refresh},null,8,["onRefresh"]),Object(r["m"])(p,{ref:"role",onRefresh:l.refresh},null,8,["onRefresh"])]})),_:1})}var s=n("5530"),d=(n("3b18"),n("f64c")),f=(n("cd17"),n("ed3b")),b=(n("159b"),n("a15b"),n("cf7c")),j=n("c1df"),O=n.n(j);function m(e,t,n,u,c,o){var a=Object(r["K"])("a-input"),i=Object(r["K"])("a-form-item"),l=Object(r["K"])("a-form"),s=Object(r["K"])("a-modal");return Object(r["D"])(),Object(r["j"])(s,{visible:e.visible,"onUpdate:visible":t[4]||(t[4]=function(t){return e.visible=t}),width:600,"ok-text":"确认","cancel-text":"取消",title:1==e.type?"新增账号":"编辑账号",onOk:u.submitHandle,onCancel:t[5]||(t[5]=function(e){return u.formRef.resetFields()})},{default:Object(r["T"])((function(){return[Object(r["m"])(l,{ref:"formRef",model:u.form,rules:u.rules,"label-col":{span:7},"wrapper-col":{span:14}},{default:Object(r["T"])((function(){return[Object(r["m"])(i,{ref:"userAccount",label:"账户名称",name:"userAccount"},{default:Object(r["T"])((function(){return[Object(r["m"])(a,{placeholder:"账户名称",style:{width:"220px"},value:u.form.userAccount,"onUpdate:value":t[1]||(t[1]=function(e){return u.form.userAccount=e})},null,8,["value"])]})),_:1},512),Object(r["m"])(i,{label:"联系方式",name:"phone"},{default:Object(r["T"])((function(){return[Object(r["m"])(a,{placeholder:"联系方式",style:{width:"220px"},value:u.form.phone,"onUpdate:value":t[2]||(t[2]=function(e){return u.form.phone=e}),valueModifiers:{trim:!0}},null,8,["value"])]})),_:1}),Object(r["m"])(i,{label:"邮箱",name:"email"},{default:Object(r["T"])((function(){return[Object(r["m"])(a,{placeholder:"邮箱",type:"email",style:{width:"220px"},value:u.form.email,"onUpdate:value":t[3]||(t[3]=function(e){return u.form.email=e}),valueModifiers:{trim:!0}},null,8,["value"])]})),_:1})]})),_:1},8,["model","rules"])]})),_:1},8,["visible","title","onOk"])}var p=n("1da1"),h=(n("96cf"),{userAccount:[{required:!0,message:"请输入",trigger:["change","blur"],type:"string"},{required:!0,message:"字符长度限制40字符",max:40,trigger:["change","blur"],type:"string"}],phone:[{required:!0,message:"请输入",trigger:["change","blur"],type:"string"},{required:!0,message:"手机格式不正确",pattern:/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/,trigger:["change","blur"],type:"string"}],email:[{required:!0,message:"请输入",trigger:["change","blur"],type:"string"},{required:!0,message:"邮箱格式不正确",pattern:/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,trigger:["change","blur"],type:"string"}]}),g={setup:function(e,t){var n=Object(r["H"])({userAccount:null,phone:null,email:null,id:null}),u=Object(r["I"])(),c=Object(r["H"])({type:1,visible:!1,menuList:[]}),o=function(){u.value.validate().then((function(){1!=c.type?Object(b["f"])(n).then((function(e){i(e)})):Object(b["b"])(n).then((function(e){i(e)}))}))},a=function(){var e=Object(p["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:c.type=1,j();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(e){1==e.code&&(d["a"].success("操作成功"),t.emit("refresh"),c.visible=!1)},l=function(e,t){return t.value.toLowerCase().indexOf(e.toLowerCase())>=0},f=function(e,t){return t.children[0].children.toLowerCase().indexOf(e.toLowerCase())>=0},j=function(){c.visible=!0,Object.assign(n,{userAccount:null,phone:null,email:null,id:null})};return Object(s["a"])(Object(s["a"])({form:n,rules:h},Object(r["O"])(c)),{},{formRef:u,submitHandle:o,showAddModal:a,filterOption:l,filterOptionPartent:f})}};g.render=m;var v=g;n("b0c0");function A(e,t,n,u,c,o){var a=Object(r["K"])("a-form-item"),i=Object(r["K"])("a-checkbox"),l=Object(r["K"])("a-checkbox-group"),s=Object(r["K"])("a-form"),d=Object(r["K"])("a-modal");return Object(r["D"])(),Object(r["j"])(d,{visible:e.visible,"onUpdate:visible":t[2]||(t[2]=function(t){return e.visible=t}),width:600,"ok-text":"确认","cancel-text":"取消",title:"定义角色",onOk:u.submitHandle},{default:Object(r["T"])((function(){return[Object(r["m"])(s,{ref:"formRef",model:u.form,rules:u.rules,"label-col":{span:7},"wrapper-col":{span:14}},{default:Object(r["T"])((function(){return[Object(r["m"])(a,{ref:"userAccount",label:"账户名称"},{default:Object(r["T"])((function(){return[Object(r["l"])(Object(r["M"])(u.form.userAccount),1)]})),_:1},512),Object(r["m"])(a,{label:"用户角色",name:"userRole"},{default:Object(r["T"])((function(){return[Object(r["m"])(l,{value:u.form.userRole,"onUpdate:value":t[1]||(t[1]=function(e){return u.form.userRole=e})},{default:Object(r["T"])((function(){return[(Object(r["D"])(!0),Object(r["j"])(r["b"],null,Object(r["J"])(e.roleList,(function(e){return Object(r["D"])(),Object(r["j"])(i,{key:e._id,value:e._id},{default:Object(r["T"])((function(){return[Object(r["l"])(Object(r["M"])(e.name),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["value"])]})),_:1})]})),_:1},8,["model","rules"])]})),_:1},8,["visible","onOk"])}var R={userRole:[{required:!0,message:"请选择",trigger:["change","blur"],type:"array"}]},k={setup:function(e,t){var n=Object(r["H"])({userAccount:null,userRole:null,id:null}),u=Object(r["I"])(),c=Object(r["H"])({visible:!1,roleList:[]}),o=function(){u.value.validate().then((function(){Object(b["p"])(n).then((function(e){l(e)}))}))},a=function(){var e=Object(p["a"])(regeneratorRuntime.mark((function e(t){var r,u,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t._id,u=t.userRole,c=t.userAccount,f(),e.next=4,i();case 4:return e.next=6,Object.assign(n,{userAccount:c,userRole:u,id:r});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i=function(){Object(b["m"])().then((function(e){1==e.code&&(c.roleList=e.data)}))},l=function(e){1==e.code&&(d["a"].success("操作成功"),t.emit("refresh"),c.visible=!1)},f=function(){c.visible=!0,Object.assign(n,{userAccount:null,userRole:null,id:null})};return Object(s["a"])(Object(s["a"])({form:n,rules:R},Object(r["O"])(c)),{},{formRef:u,submitHandle:o,showModal:a})}};k.render=A;var w=k,x={0:"已停用",1:"使用中"},M=[{title:"角色名称",dataIndex:"userAccount",align:"center",width:140},{title:"状态",dataIndex:"status",align:"center",width:100,slots:{customRender:"status"}},{title:"创建时间",dataIndex:"createTime",align:"center",width:220},{title:"用户角色",dataIndex:"userRoleName",align:"center"},{title:"联系方式",dataIndex:"phone",align:"center",width:120},{title:"邮箱",dataIndex:"email",align:"center",width:190},{title:"操作",dataIndex:"action",align:"center",width:130,fixed:"right",slots:{customRender:"action"}}],T={components:{AddEditAccount:v,DefinitionRole:w},setup:function(){var e=Object(r["I"])([]),t=Object(r["I"])(null),n=Object(r["I"])(null),u=Object(r["H"])({queryInfo:{pageSize:10,pageNumber:1}}),c=function(){Object(b["h"])(u.queryInfo).then((function(t){e.value=t.data,e.value.forEach((function(e){e.userRoleName=e.userRoleName.join(",")}))}))},o=function(){c()},a=function(){t.value.showAddModal()},i=function(e){f["a"].confirm({title:"确认要执行操作吗?",okText:"确认",cancelText:"取消",onOk:function(){Object(b["e"])(e).then((function(e){1==e.code&&(d["a"].success("操作成功"),c())}))}})},l=function(e,t){f["a"].confirm({title:"确认要执行操作吗?",okText:"确认",cancelText:"取消",onOk:function(){Object(b["a"])({id:e,status:t}).then((function(e){1==e.code&&(d["a"].success("操作成功"),c())}))}})},j=function(e){n.value.showModal(e)};Object(r["A"])((function(){c()}));var m=function(e){return x[e]};return Object(s["a"])(Object(s["a"])({columns:M,statusMap:x,data:e},Object(r["O"])(u)),{},{statusMapFilter:m,refresh:o,getList:c,addAccount:a,removeAccount:i,account:t,role:n,moment:O.a,setAccountStatus:l,setRole:j})}};T.render=l;t["default"]=T}}]);